<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××—×•×œ×œ ×“×¤×™ ×¢×‘×•×“×” ×‘×¢×‘×¨×™×ª</title>
    <style>
        body {
            font-family: 'David', 'Arial Hebrew', Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #1a73e8;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #1a73e8;
        }
        
        textarea {
            min-height: 200px;
            direction: rtl;
            resize: vertical;
        }
        
        button {
            background: linear-gradient(135deg, #1a73e8, #0d47a1);
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin-left: 10px;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        button:hover {
            background: linear-gradient(135deg, #0d47a1, #1a73e8);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);
        }
        
        .example {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 14px;
            white-space: pre-wrap;
            border-right: 4px solid #4caf50;
        }
        
        .instructions {
            background: linear-gradient(135deg, #e8f0fe, #f3e5f5);
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 8px;
            border-right: 5px solid #1a73e8;
        }
        
        .instructions h3 {
            margin-top: 0;
            color: #1a73e8;
            font-size: 1.3em;
        }
        
        .instructions ul {
            margin: 10px 0;
        }
        
        .instructions li {
            margin-bottom: 8px;
            padding-right: 10px;
        }
        
        .hidden {
            display: none;
        }
        
        /* ×¡×˜×™×™×œ×™× ×’ ×œ×“×£ ×”×¢×‘×•×“×” */
        .worksheet-container {
            background-color: white;
            max-width: 210mm;
            margin: 20px auto;
            padding: 20mm;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        
        .worksheet-header {
            text-align: center;
            margin-bottom: 20mm;
            border-bottom: 2px solid #333;
            padding-bottom: 10mm;
        }
        
        .worksheet-title {
            font-size: 28px;
            font-weight: bold;
            color: #1a73e8;
            margin-bottom: 10px;
        }
        
        .worksheet-intro {
            background-color: #f0f8ff;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 6px;
            border-right: 4px solid #1a73e8;
        }
        
        .question {
            margin-bottom: 25px;
            page-break-inside: avoid;
            background-color: #fafafa;
            padding: 15px;
            border-radius: 6px;
            border-right: 3px solid #4caf50;
        }
        
        .question-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 10px;
            color: #333;
        }
        
        .blank-line {
            display: inline-block;
            min-width: 120px;
            height: 2px;
            border-bottom: 2px solid #333;
            margin: 0 8px;
            position: relative;
            top: -2px;
        }
        
        .word-bank {
            background-color: #fff3cd;
            padding: 12px;
            margin: 10px 0;
            border-radius: 6px;
            border-right: 4px solid #ffc107;
            font-weight: bold;
        }
        
        .options {
            margin-top: 10px;
        }
        
        .option {
            margin-bottom: 8px;
            padding: 5px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        
        .option-letter {
            font-weight: bold;
            color: #1a73e8;
            margin-left: 8px;
        }
        
        .answer-space {
            margin-top: 10px;
        }
        
        .answer-line {
            height: 2em;
            border-bottom: 1px solid #999;
            margin: 8px 0;
        }
        
        .buttons {
            text-align: center;
            margin-top: 20px;
        }
        
        .font-large {
            font-size: 20px;
            line-height: 1.8;
        }
        
        .font-large .question-title {
            font-size: 20px;
        }
        
        .font-large .answer-line {
            height: 2.5em;
        }
        
        @media print {
            @page {
                size: A4;
                margin: 15mm;
            }
            
            /* ×”×¡×¨×” ××•×—×œ×˜×ª ×©×œ ×›×œ ×”×’×‘×•×œ×•×ª ×•×”×¦×‘×¢×™× */
            * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                border-right: none !important;
                border-left: none !important;
                box-shadow: none !important;
            }
            
            body {
                margin: 0 !important;
                padding: 0 !important;
                background: white !important;
                font-size: 14px !important;
                line-height: 1.4 !important;
            }
            
            .no-print {
                display: none !important;
            }
            
            .worksheet-container {
                box-shadow: none !important;
                margin: 0 !important;
                padding: 0 !important;
                border-radius: 0 !important;
                max-width: none !important;
                width: 100% !important;
            }
            
            .question {
                background-color: white !important;
                border: none !important;
                border-right: none !important;
                break-inside: avoid;
                margin-bottom: 15px !important;
                padding: 5px 0 !important;
                box-shadow: none !important;
            }
            
            .word-bank {
                background-color: white !important;
                border: 1px solid #999 !important;
                border-right: none !important;
                padding: 8px !important;
                margin: 5px 0 !important;
            }
            
            .worksheet-intro {
                background-color: white !important;
                border: 1px solid #999 !important;
                border-right: none !important;
                padding: 10px !important;
                margin-bottom: 15px !important;
            }
            
            .container {
                background: white !important;
                box-shadow: none !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            /* ×”×¡×ª×¨×ª ××œ×× ×˜×™× ××™×•×ª×¨×™× ×‘×”×“×¤×¡×” */
            .buttons, .back-button, button {
                display: none !important;
            }
            
            /* ×ª×™×§×•×Ÿ ×’×“×œ×™× ×œ×”×“×¤×¡×” */
            .worksheet-title {
                font-size: 22px !important;
                margin-bottom: 10px !important;
            }
            
            .question-title {
                font-size: 14px !important;
            }
            
            .answer-line {
                margin: 3px 0 !important;
                border-bottom: 1px solid #000 !important;
            }
        }
        
        .back-button {
            background: linear-gradient(135deg, #6c757d, #495057);
            margin-bottom: 20px;
        }
        
        .back-button:hover {
            background: linear-gradient(135deg, #495057, #6c757d);
        }
    </style>
</head>
<body>
    <div id="form-container" class="container">
        <h1>ğŸ“ ××—×•×œ×œ ×“×¤×™ ×¢×‘×•×“×” ×‘×¢×‘×¨×™×ª</h1>
        
        <div class="instructions">
            <h3>ğŸ’¡ ×”× ×—×™×•×ª ×©×™××•×©:</h3>
            <ul>
                <li><strong>×©××œ×•×ª ×¤×ª×•×—×•×ª:</strong> ×™×§×‘×œ×• ×©×•×¨×•×ª ×œ××¢× ×”</li>
                <li><strong>×©××œ×•×ª ×¨×‘-×‘×¨×™×¨×”:</strong> ×™×–×•×”×• ×œ×¤×™ ××¤×©×¨×•×™×•×ª (×), (×‘), (×’), (×“)</li>
                <li><strong>×©××œ×•×ª ×”×©×œ××”:</strong> ×™×–×•×”×• ×œ×¤×™ ×§×•×•×™× ×ª×—×ª×•× ×™× _____</li>
                <li><strong>××—×¡×Ÿ ××™×œ×™×:</strong> ×”×•×¡×£ "××—×¡×Ÿ ××™×œ×™×:" ×•××—×¨×™×• ×”××™×œ×™×</li>
                <li><strong>×—×œ×•×§×ª ×©××œ×•×ª:</strong> ×”×¤×¨×“ ×©××œ×•×ª ×¢× ×©×•×¨×” ×¨×™×§×” ××• ××¡×¤×¨ ×©××œ×•×ª</li>
            </ul>
        </div>
        
        <div class="form-group">
            <label for="title">ğŸ“ ×›×•×ª×¨×ª ×”×“×£:</label>
            <input type="text" id="title" placeholder="×œ×“×•×’××”: ×“×£ ×¢×‘×•×“×” ×‘×›×“×•×¨×¡×œ" required>
        </div>
        
        <div class="form-group">
            <label for="student-name">ğŸ‘¤ ×©× ×”×ª×œ××™×“ (××•×¤×¦×™×•× ×œ×™):</label>
            <input type="text" id="student-name" placeholder="×©×: _____________">
        </div>
        
        <div class="form-group">
            <label for="class-name">ğŸ« ×›×™×ª×” (××•×¤×¦×™×•× ×œ×™):</label>
            <input type="text" id="class-name" placeholder="×›×™×ª×”: ___________">
        </div>
        
        <div class="form-group">
            <label for="font-size">ğŸ”¤ ×’×•×“×œ ×’×•×¤×Ÿ:</label>
            <select id="font-size">
                <option value="regular">×’×•×¤×Ÿ ×¨×’×™×œ</option>
                <option value="large">×’×•×¤×Ÿ ×’×“×•×œ - ×œ×ª×œ××™×“×™× ××ª×§×©×™×</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="intro">ğŸ“– ×˜×§×¡×˜ ××‘×•× (××•×¤×¦×™×•× ×œ×™):</label>
            <textarea id="intro" placeholder="×”×›× ×¡ ×›××Ÿ ×˜×§×¡×˜ ××‘×•× ×©×™×•×¤×™×¢ ×œ×¤× ×™ ×”×©××œ×•×ª..."></textarea>
        </div>
        
        <div class="form-group">
            <label for="questions">â“ ×”×©××œ×•×ª:</label>
            <textarea id="questions" placeholder="×”×“×‘×§ ×›××Ÿ ××ª ×”×©××œ×•×ª..." required></textarea>
            <div class="example">×“×•×’×××•×ª ×œ×©××œ×•×ª:

×”×©×œ×™××• ××ª ×”××©×¤×˜ ×‘×¢×–×¨×ª ××—×¡×Ÿ ×”××™×œ×™×:
××ª _______ ×”×›×“×•×¨×¡×œ ×”××¦×™× _______.
×”×›×“×•×¨ ×™×•×¦× ××”××’×¨×© â€“ ×¢×•×¦×¨×™× ××ª _______.
××©×—×§ ×›×“×•×¨×¡×œ × ××©×š _______ ×“×§×•×ª.
××—×¡×Ÿ ××™×œ×™×: ××©×—×§ | ×”×©×¢×•×Ÿ | 40 | ×’'×™×™××¡ × ×™×¡××™×ª

××”×• ×—×•×§ 30 ×”×©× ×™×•×ª ×‘××©×—×§ ×›×“×•×¨×¡×œ?
(×) ×—×•×§ ×©××¡×•×¨×• ×œ×¨×•×¥ ×‘×œ×™ ×›×“×•×¨
(×‘) ×—×•×§ ×©××¡×•×¨×• ×œ×”×—×–×™×§ ×‘×›×“×•×¨ ×™×•×ª×¨ ×-30 ×©× ×™×•×ª
(×’) ×—×•×§ ×©××ª×™×¨ ×œ×”×™×•×ª ××ª×—×ª ×œ×¡×œ
(×“) ×—×•×§ ×©××•××¨ ×©×”××©×—×§ × ××©×š 30 ×©× ×™×•×ª

×”×¡×‘×¨/×™ ××“×•×¢ ×¢×•×¦×¨×™× ××ª ×”×©×¢×•×Ÿ ×‘××”×œ×š ××©×—×§ ×”×›×“×•×¨×¡×œ.</div>
        </div>
        
        <button onclick="createWorksheet()">âœ¨ ×¦×•×¨ ×“×£ ×¢×‘×•×“×”</button>
        <button type="button" onclick="clearForm()">ğŸ—‘ï¸ × ×§×” ×˜×•×¤×¡</button>
    </div>
    
    <div id="worksheet-container" class="hidden">
        <div class="buttons no-print">
            <button class="back-button" onclick="goBack()">ğŸ”™ ×—×–×•×¨ ×œ×¢×¨×™×›×”</button>
            <button onclick="printClean()">ğŸ–¨ï¸ ×”×“×¤×¡×” × ×§×™×™×”</button>
            <button onclick="window.print()">ğŸ–¨ï¸ ×”×“×¤×¡ ×¨×’×™×œ</button>
            <button onclick="downloadWorksheet()">ğŸ“„ ×©××•×¨ ×›-PDF</button>
        </div>
        
        <div id="worksheet-content" class="worksheet-container">
            <!-- ×›××Ÿ ×™×•×¤×™×¢ ×“×£ ×”×¢×‘×•×“×” -->
        </div>
    </div>

    <script>
        function processQuestions(text) {
            if (!text) return [];
            
            text = text.trim();
            const questionBlocks = [];
            
            // ××¤×¦×œ ×œ×¤×™ ×©×•×¨×•×ª ×¨×™×§×•×ª ××• ××¡×¤×•×¨ ×©××œ×•×ª
            const lines = text.split('\n');
            let currentBlock = '';
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                // ×‘×“×™×§×” ×× ×–×• ×”×ª×—×œ×” ×©×œ ×©××œ×” ×—×“×©×”
                const isNewQuestion = (
                    (line.match(/^×©××œ×”\s+\d+/i) || line.match(/^\d+\./)) ||
                    (i > 0 && lines[i - 1].trim() === '' && line !== '' && currentBlock.trim())
                );
                
                if (isNewQuestion && currentBlock.trim()) {
                    questionBlocks.push(currentBlock.trim());
                    currentBlock = line;
                } else {
                    currentBlock += (currentBlock ? '\n' : '') + line;
                }
            }
            
            if (currentBlock.trim()) {
                questionBlocks.push(currentBlock.trim());
            }
            
            return questionBlocks
                .filter(block => block.length > 0)
                .map((block, index) => processQuestionBlock(block, index + 1));
        }
        
        function processQuestionBlock(block, number) {
            let text = block.replace(/^×©××œ×”\s+\d+\.?|^\d+\./, '').trim();
            
            let wordBank = '';
            
            // ×—×™×œ×•×¥ ××—×¡×Ÿ ××™×œ×™×
            if (text.includes('××—×¡×Ÿ ××™×œ×™×:')) {
                const parts = text.split(/××—×¡×Ÿ ××™×œ×™×:/i);
                text = parts[0].trim();
                if (parts.length > 1) {
                    wordBank = parts[1].trim();
                }
            }
            
            // ×–×™×”×•×™ ×¡×•×’ ×”×©××œ×”
            let type = 'open';
            let options = [];
            
            // ×‘×“×™×§×” ×œ×©××œ×ª ×”×©×œ××”
            if (text.includes('_') || /×”×©×œ×™××•|×”×©×œ×|××œ×/i.test(text)) {
                type = 'fill-in-blanks';
            }
            // ×‘×“×™×§×” ×œ×©××œ×ª ×¨×‘-×‘×¨×™×¨×”
            else if (hasMultipleChoiceOptions(text)) {
                type = 'multiple-choice';
                const extracted = extractMultipleChoiceOptions(text);
                text = extracted.questionText;
                options = extracted.choiceOptions;
            }
            
            return {
                number: number,
                text: text,
                type: type,
                wordBank: wordBank,
                options: options
            };
        }
        
        function hasMultipleChoiceOptions(text) {
            const optionPatterns = [
                /\([×-×ª]\)/g,
                /^\s*[×-×ª]\)/gm
            ];
            
            let count = 0;
            for (const pattern of optionPatterns) {
                const matches = text.match(pattern);
                if (matches) count += matches.length;
            }
            
            return count >= 2;
        }
        
        function extractMultipleChoiceOptions(text) {
            const lines = text.split('\n');
            const questionLines = [];
            const optionLines = [];
            let foundOptions = false;
            
            for (const line of lines) {
                const trimmed = line.trim();
                
                const isOption = trimmed.match(/^\s*\([×-×ª]\)/) || 
                                trimmed.match(/^\s*[×-×ª]\)/) ||
                                /\([×-×ª]\)/.test(trimmed);
                
                if (isOption) {
                    foundOptions = true;
                    
                    let cleaned = trimmed
                        .replace(/^\s*\([×-×ª]\)\s*/, '')
                        .replace(/^\s*[×-×ª]\)\s*/, '')
                        .replace(/\([×-×ª]\)\s*/, '')
                        .trim();
                    
                    if (cleaned) {
                        optionLines.push(cleaned);
                    }
                } else if (!foundOptions && trimmed) {
                    questionLines.push(trimmed);
                }
            }
            
            return {
                questionText: questionLines.join('\n'),
                choiceOptions: optionLines
            };
        }
        
        function generateQuestionHTML(question) {
            const questionText = question.text.replace(/_+/g, '<span class="blank-line"></span>');
            
            let html = `
                <div class="question">
                    <div class="question-title">×©××œ×” ${question.number}. ${questionText}</div>
            `;
            
            // ××—×¡×Ÿ ××™×œ×™×
            if (question.wordBank) {
                html += `<div class="word-bank">××—×¡×Ÿ ××™×œ×™×: ${formatWordBank(question.wordBank)}</div>`;
            }
            
            // ××¤×©×¨×•×™×•×ª ×¨×‘-×‘×¨×™×¨×”
            if (question.type === 'multiple-choice' && question.options.length > 0) {
                html += `<div class="options">`;
                const letters = ['×', '×‘', '×’', '×“', '×”', '×•', '×–', '×—', '×˜', '×™'];
                
                for (let i = 0; i < question.options.length; i++) {
                    html += `
                        <div class="option">
                            <span class="option-letter">(${letters[i]})</span>
                            <span>${question.options[i]}</span>
                        </div>
                    `;
                }
                
                html += `</div>`;
            }
            
            // ×©×•×¨×•×ª ×œ××¢× ×” (×©××œ×•×ª ×¤×ª×•×—×•×ª)
            if (question.type === 'open') {
                html += `<div class="answer-space">`;
                for (let i = 0; i < 4; i++) {
                    html += `<div class="answer-line"></div>`;
                }
                html += `</div>`;
            }
            
            html += `</div>`;
            return html;
        }
        
        function formatWordBank(wordBank) {
            if (wordBank.includes('|')) {
                return wordBank.split('|').map(w => w.trim()).join(' | ');
            } else if (wordBank.includes(',')) {
                return wordBank.split(',').map(w => w.trim()).join(' | ');
            }
            return wordBank;
        }
        
        function createWorksheet() {
            const title = document.getElementById('title').value;
            const studentName = document.getElementById('student-name').value;
            const className = document.getElementById('class-name').value;
            const intro = document.getElementById('intro').value;
            const questions = document.getElementById('questions').value;
            const fontSize = document.getElementById('font-size').value;
            
            if (!title || !questions) {
                alert('×× × ××œ× ××ª ×©×“×•×ª ×”×›×•×ª×¨×ª ×•×”×©××œ×•×ª');
                return;
            }
            
            const processedQuestions = processQuestions(questions);
            
            if (processedQuestions.length === 0) {
                alert('×œ× × ××¦××• ×©××œ×•×ª ×ª×§×™× ×•×ª. ×× × ×‘×“×•×§ ××ª ×”×¤×•×¨××˜');
                return;
            }
            
            const fontClass = fontSize === 'large' ? 'font-large' : '';
            
            let headerInfo = '';
            if (studentName) headerInfo += `<div>×©×: ${studentName}</div>`;
            if (className) headerInfo += `<div>×›×™×ª×”: ${className}</div>`;
            if (headerInfo) headerInfo = `<div style="text-align: right; margin-bottom: 15px; font-size: 14px;">${headerInfo}</div>`;
            
            const worksheetHTML = `
                <div class="${fontClass}">
                    <div class="worksheet-header">
                        <div class="worksheet-title">${title}</div>
                        ${headerInfo}
                    </div>
                    
                    ${intro ? `<div class="worksheet-intro">${intro}</div>` : ''}
                    
                    <div class="questions">
                        ${processedQuestions.map(q => generateQuestionHTML(q)).join('')}
                    </div>
                </div>
            `;
            
            document.getElementById('worksheet-content').innerHTML = worksheetHTML;
            document.getElementById('form-container').classList.add('hidden');
            document.getElementById('worksheet-container').classList.remove('hidden');
        }
        
        function goBack() {
            document.getElementById('form-container').classList.remove('hidden');
            document.getElementById('worksheet-container').classList.add('hidden');
        }
        
        function clearForm() {
            document.getElementById('title').value = '';
            document.getElementById('student-name').value = '';
            document.getElementById('class-name').value = '';
            document.getElementById('intro').value = '';
            document.getElementById('questions').value = '';
            document.getElementById('font-size').value = 'regular';
        }
        
        function downloadWorksheet() {
            // ×”×¡×ª×¨×ª ×”×›×¤×ª×•×¨×™× ×œ×¤× ×™ ×”×”×“×¤×¡×”
            const buttons = document.querySelector('.buttons');
            buttons.style.display = 'none';
            
            // ×”×“×¤×¡×”
            window.print();
            
            // ×”×—×–×¨×ª ×”×›×¤×ª×•×¨×™× ××—×¨×™ ×”×”×“×¤×¡×”
            setTimeout(() => {
                buttons.style.display = 'block';
            }, 1000);
        }
        
        // ×¤×•× ×§×¦×™×” × ×•×¡×¤×ª ×œ×”×“×¤×¡×” × ×§×™×™×”
        function printClean() {
            const printContents = document.getElementById('worksheet-content').innerHTML;
            
            // ×™×¦×™×¨×ª ×—×œ×•×Ÿ ×”×“×¤×¡×” × ×§×™ ×œ×—×œ×•×˜×™×Ÿ
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html lang="he" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <title>×“×£ ×¢×‘×•×“×”</title>
                    <style>
                        @page {
                            size: A4;
                            margin: 20mm;
                        }
                        
                        body {
                            font-family: 'David', 'Arial Hebrew', Arial, sans-serif;
                            direction: rtl;
                            margin: 0;
                            padding: 0;
                            font-size: 14px;
                            line-height: 1.5;
                            color: black;
                            background: white;
                        }
                        
                        .worksheet-header {
                            text-align: center;
                            margin-bottom: 20px;
                            border-bottom: 1px solid #000;
                            padding-bottom: 10px;
                        }
                        
                        .worksheet-title {
                            font-size: 24px;
                            font-weight: bold;
                            margin-bottom: 10px;
                        }
                        
                        .question {
                            margin-bottom: 20px;
                            padding: 0;
                            break-inside: avoid;
                        }
                        
                        .question-title {
                            font-weight: bold;
                            margin-bottom: 8px;
                        }
                        
                        .word-bank {
                            background-color: #f5f5f5;
                            border: 1px solid #ccc;
                            padding: 8px;
                            margin: 8px 0;
                            font-weight: bold;
                        }
                        
                        .worksheet-intro {
                            background-color: #f5f5f5;
                            border: 1px solid #ccc;
                            padding: 10px;
                            margin-bottom: 15px;
                        }
                        
                        .options {
                            margin-top: 5px;
                        }
                        
                        .option {
                            margin-bottom: 5px;
                        }
                        
                        .option-letter {
                            font-weight: bold;
                            margin-left: 8px;
                        }
                        
                        .answer-line {
                            height: 1.5em;
                            border-bottom: 1px solid #000;
                            margin: 8px 0;
                        }
                        
                        .blank-line {
                            display: inline-block;
                            min-width: 100px;
                            height: 1px;
                            border-bottom: 1px solid #000;
                            margin: 0 5px;
                        }
                    </style>
                </head>
                <body>
                    ${printContents}
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }
    </script>
</body>
</html>